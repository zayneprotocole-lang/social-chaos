import{aE as y,aF as $,a as o,d as F,cw as M,aR as U,d2 as j,b5 as D,d3 as I,d4 as O,cP as L,bc as N,d5 as T,ca as R,d1 as V,d6 as W,c_ as q,h as z}from"./sanity.config-DDbzIdEq.js";function A(s){return y(function(e,t){var r=!1,i=0;e.subscribe($(t,function(a){return(r||(r=!s(a,i++)))&&t.next(a)}))})}const B=s=>{const e=F.c(16),{comlink:t,refs:r,perspective:i}=s,a=M(),c=U();let p;e[0]===Symbol.for("react.memo_cache_sentinel")?(p=new j,e[0]=p):p=e[0];const w=p;let u;e[1]!==a||e[2]!==i||e[3]!==c?(u=w.asObservable().pipe(D(g=>O(g.map(n=>{const S={...n,_id:L(n._id)},E=i==="published"?N:a.observeForPreview(S,c.get(S._type)).pipe(T(),A(C)),x={...n,_id:R(n._id)},k=a.observeForPreview(x,c.get(x._type));return V(k.pipe(W(E)),E).pipe(q(G),z(H))}))),I(0)),e[1]=a,e[2]=i,e[3]=c,e[4]=u):u=e[4];const l=u;let d;e[5]===Symbol.for("react.memo_cache_sentinel")?(d=[],e[5]=d):d=e[5];const P=o.useRef(d);let b,m;e[6]!==t||e[7]!==l?(b=()=>{const g=l.subscribe(n=>{t.post("presentation/preview-snapshots",{snapshots:n}),P.current=n});return()=>{g.unsubscribe()}},m=[t,l],e[6]=t,e[7]=l,e[8]=b,e[9]=m):(b=e[8],m=e[9]),o.useEffect(b,m);let f,h;e[10]!==t?(f=()=>t.on("visual-editing/preview-snapshots",()=>({snapshots:P.current})),h=[t],e[10]=t,e[11]=f,e[12]=h):(f=e[11],h=e[12]),o.useEffect(f,h);let v,_;return e[13]!==r?(v=()=>{w.next(r)},_=[r,w],e[13]=r,e[14]=v,e[15]=_):(v=e[14],_=e[15]),o.useEffect(v,_),null};var K=o.memo(B);function C(s){return s.snapshot===null}function G(s){return!!s.snapshot}function H(s){const e=s.snapshot;return{_id:R(e._id),title:e.title,subtitle:e.subtitle,description:e.description,imageUrl:e.imageUrl}}export{K as default};
